var dctk=window.dctk=window.dctk||{};dctk.logging=dctk.logging||{};var collectedErrors=window.collectedErrors;(function(){if(dctk.logging._loaded||dctk._loggingLoaded){setTimeout(function(){throw new Error("Client Logging was attempted to be loaded twice")});return}dctk.logging._loaded=true;(function(){var B;B=(function(){var i=false;return{hasEntry:function(){return Boolean(this.getEntryAsQueryStringParameter())},getEntryAsQueryStringParameter:function(){if(i||!dctk.ewePerformance){return""}var M=dctk.ewePerformance.getPageUsableTime();if(!M||!M.length){return""}return"pageUsableTime="+Math.round(M[0].startTime)},markAsSent:function(){i=true}}}());if(dctk.logging.enabled==null){dctk.logging.enabled=true}if(!dctk.logging.enabled){return}var F="/cl/1x1.gif",h="/cl/2x2.gif",m=[];var G=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];var C=[{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Kindle",identity:"Kindle"},{string:navigator.userAgent,subString:"BB10",identity:"Blackberry"},{string:navigator.userAgent,subString:"Touch",addlString:"MSIE 10",identity:"Surface"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];var n;dctk.logging.setProduction=function(i){n=i};dctk.logging._isProduction=function(){return n!=null?n:dctk.logging._isAProductionDomain()};var v=["www.expedia.com","www.expedia.co.uk","www.expedia.ca","www.expedia.de","www.expedia.it","www.expedia.es","www.expedia.nl","www.expedia.mx","www.expedia.com.sg","www.expedia.com.my","www.expedia.co.kr","www.expedia.co.th","www.expedia.com.hk","www.expedia.fr","www.expedia.com.au","www.expedia.co.in","www.expedia.co.jp","www.expedia.co.nz","www.expedia.co.id","www.expedia.com.tw","www.expedia.ie","www.expedia.be","www.expedia.se","www.expedia.no","www.expedia.dk","www.expedia.com.ph","www.expedia.com.br","www.expedia.com.ar","www.expedia.com.vn","www.expedia.fi","www.expedia.at","expedia.viaggi.virgilio.it","expedia.viaggi.tiscali.it","expedia.corriere.it","expedia.viaggi.deejay.it","expedia.allmusic.tv","voyages.anyway.com","yahoo.expedia.com.au","ninemsn.expedia.com.au","jal.expedia.co.jp","msn.expedia.co.jp","expedia-aarp.com","voyage-sncf.com","expediafortd.com","vacation.hotwire.com","www.travelocity.com","www.travelocity.ca","xsell.expedia.com","www.airasiago.com.my","orbitz.com",/(^|\.)wotif\.(com|co\.nz)$/];dctk.logging._isAProductionDomain=function(N){N=N||{};N._domain=N._domain||r;N._productionDomains=N._productionDomains||v;for(var M=0;M<N._productionDomains.length;M++){if(N._domain.match(N._productionDomains[M])){return true}}return false};var u=function(P){for(var M=0;M<P.length;M++){var N=P[M].string;var O=P[M].prop;dctk.logging.versionSearchString=P[M].versionSearch||P[M].identity;if(N){if(N.indexOf(P[M].subString)!=-1&&(!P[M].addlString||N.indexOf(P[M].addlString)!=-1)){return P[M].identity||"unknown"}}else{if(O){return P[M].identity||"unknown"}}}};var j=function(M){var i=M.indexOf(dctk.logging.versionSearchString);if(i==-1){return}return parseFloat(M.substring(i+dctk.logging.versionSearchString.length+1))};var x=function(i){if(i.toISOString){return i.toISOString()}else{return i.getFullYear().toString()+"-"+i.getMonth()+"-"+i.getDate()+"T"+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()}};var l=function(N,M,i){if(N.attachEvent){N["e"+M+i]=i;N[M+i]=function(){N["e"+M+i](window.event)};N.attachEvent("on"+M,N[M+i])}else{N.addEventListener(M,i,false)}};var p=function(i){if(B.hasEntry()){i.push(B.getEntryAsQueryStringParameter());B.markAsSent()}w(F+g+"&pageName="+dctk.logging.pageName+"&guid="+J()+"&logTime="+x(new Date())+"&sessionDuration="+encodeURIComponent(f())+"&action=logTrxEvent&"+(i||[]).join("&"))};var J=function(){return dctk.logging.guid||"unknown"};var E=function(){if(dctk.logging.gcoAgent){return"&gcoAgent=true&agentLogonName="+(dctk.logging.agentLogonName||"unknown")+"&agentCallCenter="+(dctk.logging.agentCallCenter||"unknown")+"&agentCountry="+(dctk.logging.agentCountry||"unknown")}else{if(dctk.logging.gcoAgent==null){return""}else{return"&gcoAgent=false"}}};var q=function(i){return window.performance&&performance.timing&&performance.timing[i]||NaN};var c=u(G);var K=j(navigator.userAgent)||j(navigator.appVersion)||"an unknown version";var r=window.location.hostname;var s=u(C);var L="";if(dctk.logging.data){for(var I=0,y=dctk.logging.data.split("|");I<y.length&&y[I].length>0;I++){L+="&"+y[I]}}var g="?browser="+c+"&browserVersion="+K+"&platform="+s+"&domain="+r+"&live="+dctk.logging._isProduction()+L+E();if("performance" in window){dctk.logging.pageStartTime=window.performance.timing.responseStart}else{dctk.logging.pageStartTime=dctk.logging.pageStartTime||new Date().getTime()}var D=function(i){if(document.readyState=="complete"){i()}else{l(window,"load",i)}};var a=function(i){D(function(){i({unloadTime:q("unloadEventEnd")-q("unloadEventStart"),redirectTime:q("redirectEnd")-q("redirectStart"),dnsTime:q("domainLookupEnd")-q("domainLookupStart"),connectionTime:q("connectEnd")-q("connectStart"),requestTime:q("responseStart")-q("requestStart"),responseTime:q("responseEnd")-q("responseStart"),parsingTime:q("domInteractive")-q("domLoading"),domReadyCallbackTime:q("domContentLoadedEventEnd")-q("domContentLoadedEventStart"),onLdCallbackTime:q("loadEventEnd")-q("loadEventStart"),processingTime:q("domComplete")-q("domLoading"),navigationToResponse:q("responseStart")-q("navigationStart"),navigationToDomContentLoaded:q("domContentLoadedEventStart")-q("navigationStart"),navigationToOnLd:q("loadEventStart")-q("navigationStart"),fetchToResponse:q("responseStart")-q("fetchStart"),fetchToDomContentLoaded:q("domContentLoadedEventStart")-q("fetchStart"),fetchToOnLd:q("loadEventStart")-q("fetchStart"),responseToDomContentLoaded:q("domContentLoadedEventStart")-q("responseStart"),responseToOnLd:q("loadEventStart")-q("responseStart"),navigationToDomInteractive:q("domInteractive")-q("navigationStart")})})};dctk.logging.navTiming={};dctk.logging.browser=c;dctk.logging.version=K;dctk.logging.OS=s;dctk.logging.logTrxEvent=function(i,M){var N=[i+"_elapsedTime="+(new Date().getTime()-dctk.logging.pageStartTime)];if(M){N=N.concat(dctk.logging._normalizeMessageParams(M))}p(N)};dctk.logging.trxEventWrapper=function(N,i,M){return function(){var Q=new Date().getTime();var O=N.apply((M?M:dctk.logging),arguments);var P=new Date().getTime();p([i+"_elapsedTime="+(P-dctk.logging.pageStartTime),"clEventName01="+i,"clEventTime01="+(P-Q)]);return O}};dctk.logging.logMessage=function(i,M){var N=dctk.logging._normalizeMessageParams((function(){var O={logTime:x(new Date),action:"logErrors",label:i,pageName:dctk.logging.pageName,pageUrl:window.location.href,guid:J(),clientWidth:document.documentElement.clientWidth};O[i+"_elapsedTime"]=new Date().getTime()-dctk.logging.pageStartTime;return O})());N=N.concat(dctk.logging._normalizeMessageParams(M));w(h+g+"&"+N.join("&"))};dctk.logging.logError=function(N,M,i){var O=dctk.logging._normalizeMessageParams(M?o(M):{onError:"NA"});O=O.concat(dctk.logging._normalizeMessageParams(i));dctk.logging.logMessage(N,O);b(N+"\n"+O.join("\n"))};dctk.logging.reset=function(){dctk.logging.pageStartTime=new Date().getTime()};dctk.logging.subscribeToOnerrorCallback=function(i){m.push(i)};dctk.logging.publishOnerrorCallback=function(){for(var M=0;M<m.length;M++){if(typeof m[M]==="function"){m[M]()}}};dctk.logging.setPageName=function(i){dctk.logging.pageName=i};var H=window.onerror;var t={};dctk.logging._onerror=function(Q,N,i,P,M){var S=M?o(M):{onErrorMsg:Q};S.onErrorUrl=N;S.onErrorLine=i;S.onErrorChar=P==null?"NA":P;t[Q]=(t[Q]||0)+1;var R=t[Q]==100;if(R){S.exceedsErrorThreshold="true"}var O=t[Q]==1||R;if(O){dctk.logging.logMessage("windowOnError",S)}dctk.logging.publishOnerrorCallback()};window.onerror=function(){try{if(H){H.apply(window,arguments)}}finally{dctk.logging._onerror.apply(dctk.logging,arguments)}};dctk.loggingAdapter=dctk.logging;dctk.logging._normalizeMessageParams=function(M){if(!M){return[]}if(typeof M=="string"){return[M]}if(!(M instanceof Array)){var N=[];for(var i in M){N.push(encodeURIComponent(i)+"="+encodeURIComponent(A(M[i])))}M=N}return M};var A=function(i){return'"'+String(i).replace(/"/g,"???")+'"'};var b=function(i){try{console.error(i)}catch(N){try{console.log(i)}catch(M){}}};dctk.logging._beaconImages=[];var w=function(i){var M=new Image;M.src=i;dctk.logging._beaconImages.push(M)};var o=function(i){i=e(i);return{onErrorMsg:i.message,onErrorUrl:i.sourceURL,onErrorLine:i.line,onErrorChar:i.col,stack:i.stack?i.stack.substr(0,200):"NA"}};var e=function(P){var M="NA",N=M,i=M,R=M,Q;try{if(P&&P.stack){Q=P.stack.match(/\(([^\)]+\d+)\)/);if(!Q){Q=P.stack.match(/@([^\)]+\d+)\n/)}if(Q){Q=Q[1].split(":");N=Q.pop();i=Q.pop();R=Q.join(":")}}}catch(O){}if(P){P={sourceURL:P.sourceURL||P.fileName||R,line:P.line||P.lineNumber||i,col:P.columnNumber||N,message:P.message,stack:P.stack||M}}return P};var f=function(){var i,O,S,P,N,Q,R;O=new Date().getTime();try{if(!window.localStorage){return}S="dctk_clientLogging_firstInteractionTimestamp";P="dctk_clientLogging_lastInteractionTimestamp";N=Number(localStorage.getItem(P));i=Number(localStorage.getItem(S));Q=O-N>30*60*1000;R=i===0;if(Q||R){i=O;localStorage.setItem(S,i)}N=O;localStorage.setItem(P,N)}catch(M){i=O}return O-i};var d=function(M){var O=[];for(var i in M){var N=M[i];if(N==null||isNaN(N)){continue}O.push(encodeURIComponent(i)+"="+encodeURIComponent(N))}return O.join("&")};(function k(){a(function(M){dctk.logging.navTiming=M;var i=d(M);if(B.hasEntry()){i=[i,B.getEntryAsQueryStringParameter()].join("&");B.markAsSent()}dctk.logging.logTrxEvent("navTiming",i)})})();(function z(){setInterval(p([]),1*60*1000)})()})();if(typeof define=="function"&&define.amd){define("dctk/clientLogging",function(){return dctk.logging})}})();if(collectedErrors){collectedErrors.forEach(function(a){dctk.logging.logError(a)});collectedErrors=null};